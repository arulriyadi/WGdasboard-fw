import{_ as A,r as u,o as E,c as n,b as e,f as c,F,h as U,J as D,m as b,B as y,y as w,e as h,n as _,t as i,g as N,A as k,a as r,K as V}from"./index-Ds3XhhR3.js";const S={class:"container-fluid"},I={class:"row"},M={class:"col-12"},O={class:"d-flex justify-content-between align-items-center mb-4"},$={class:"card"},B={class:"card-body"},J={key:0,class:"text-center py-4"},q={key:1,class:"text-center py-4 text-muted"},L={key:2,class:"table-responsive"},W={class:"table table-striped table-hover"},j={class:"badge bg-secondary"},z={key:0,class:"badge bg-info"},G={key:1,class:"text-muted"},K=["onClick"],H={key:0,class:"modal show d-block",tabindex:"-1",style:{"background-color":"rgba(0,0,0,0.5)"}},Q={class:"modal-dialog modal-lg"},X={class:"modal-content"},Y={class:"modal-header"},Z={class:"modal-body"},ee={class:"row"},se={class:"col-md-6 mb-3"},le={class:"col-md-6 mb-3"},te={class:"row"},oe={class:"col-md-6 mb-3"},ae={class:"col-md-6 mb-3"},ne={class:"row"},re={class:"col-md-6 mb-3"},ie={class:"col-md-6 mb-3"},de={class:"modal-footer"},ue=["disabled"],ce={key:0,class:"spinner-border spinner-border-sm me-1"},be={class:"toast-container position-fixed bottom-0 end-0 p-3"},ve={key:0,class:"toast show",role:"alert"},pe={class:"toast-header"},me={class:"ms-2"},fe={class:"toast-body"},ge={__name:"firewall",setup(ye){const f=u(!0),p=u(!1),v=u(!1),g=u([]),o=u({chain:"",target:"",source:"",destination:"",protocol:"",port:""}),d=u({show:!1,type:"success",message:""}),m=async()=>{try{f.value=!0;const t=await N("/api/firewall/rules");t.status?g.value=t.data||[]:a("error","Failed to load firewall rules")}catch(t){a("error","Error loading firewall rules: "+t.message)}finally{f.value=!1}},C=async()=>{try{p.value=!0;const t=await k("/api/firewall/rules",o.value);t.status?(a("success","Firewall rule added successfully"),v.value=!1,x(),await m()):a("error",t.message||"Failed to add firewall rule")}catch(t){a("error","Error adding firewall rule: "+t.message)}finally{p.value=!1}},R=async t=>{if(confirm("Are you sure you want to delete this firewall rule?"))try{const s=await V(`/api/firewall/rules/${t}`);s.status?(a("success","Firewall rule deleted successfully"),await m()):a("error",s.message||"Failed to delete firewall rule")}catch(s){a("error","Error deleting firewall rule: "+s.message)}},T=async()=>{try{const t=await k("/api/firewall/reload",{});t.status?(a("success","Firewall rules reloaded successfully"),await m()):a("error",t.message||"Failed to reload firewall rules")}catch(t){a("error","Error reloading firewall rules: "+t.message)}},x=()=>{o.value={chain:"",target:"",source:"",destination:"",protocol:"",port:""}},a=(t,s)=>{d.value={show:!0,type:t,message:s},setTimeout(()=>{d.value.show=!1},5e3)},P=t=>{switch(t){case"ACCEPT":return"bg-success";case"DROP":return"bg-danger";case"REJECT":return"bg-warning";default:return"bg-secondary"}};return E(()=>{m()}),(t,s)=>(r(),n("div",S,[e("div",I,[e("div",M,[e("div",O,[s[12]||(s[12]=e("h2",{class:"mb-0"},[e("i",{class:"bi bi-shield-check me-2"}),c(" Firewall Management ")],-1)),e("div",null,[e("button",{class:"btn btn-primary me-2",onClick:s[0]||(s[0]=l=>v.value=!0)},s[10]||(s[10]=[e("i",{class:"bi bi-plus-circle me-1"},null,-1),c(" Add Rule ")])),e("button",{class:"btn btn-warning",onClick:T},s[11]||(s[11]=[e("i",{class:"bi bi-arrow-clockwise me-1"},null,-1),c(" Reload Rules ")]))])]),e("div",$,[s[17]||(s[17]=e("div",{class:"card-header"},[e("h5",{class:"mb-0"},[e("i",{class:"bi bi-list-ul me-2"}),c(" Current Firewall Rules ")])],-1)),e("div",B,[f.value?(r(),n("div",J,s[13]||(s[13]=[e("div",{class:"spinner-border text-primary",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1)]))):g.value.length===0?(r(),n("div",q,s[14]||(s[14]=[e("i",{class:"bi bi-shield-x fs-1"},null,-1),e("p",{class:"mt-2"},"No firewall rules found",-1)]))):(r(),n("div",L,[e("table",W,[s[16]||(s[16]=e("thead",{class:"table-dark"},[e("tr",null,[e("th",null,"ID"),e("th",null,"Chain"),e("th",null,"Source"),e("th",null,"Destination"),e("th",null,"Protocol"),e("th",null,"Port"),e("th",null,"Target"),e("th",null,"Actions")])],-1)),e("tbody",null,[(r(!0),n(F,null,U(g.value,l=>(r(),n("tr",{key:l.id},[e("td",null,i(l.id),1),e("td",null,[e("span",j,i(l.chain||"N/A"),1)]),e("td",null,i(l.source||"Any"),1),e("td",null,i(l.destination||"Any"),1),e("td",null,[l.protocol?(r(),n("span",z,i(l.protocol),1)):(r(),n("span",G,"Any"))]),e("td",null,i(l.port||"Any"),1),e("td",null,[e("span",{class:_(["badge",P(l.target)])},i(l.target||"N/A"),3)]),e("td",null,[e("button",{class:"btn btn-sm btn-outline-danger",onClick:we=>R(l.id)},s[15]||(s[15]=[e("i",{class:"bi bi-trash"},null,-1)]),8,K)])]))),128))])])]))])])])]),v.value?(r(),n("div",H,[e("div",Q,[e("div",X,[e("div",Y,[s[18]||(s[18]=e("h5",{class:"modal-title"},[e("i",{class:"bi bi-plus-circle me-2"}),c(" Add Firewall Rule ")],-1)),e("button",{type:"button",class:"btn-close",onClick:s[1]||(s[1]=l=>v.value=!1)})]),e("div",Z,[e("form",{onSubmit:D(C,["prevent"])},[e("div",ee,[e("div",se,[s[20]||(s[20]=e("label",{for:"chain",class:"form-label"},"Chain",-1)),b(e("select",{id:"chain","onUpdate:modelValue":s[2]||(s[2]=l=>o.value.chain=l),class:"form-select",required:""},s[19]||(s[19]=[e("option",{value:""},"Select Chain",-1),e("option",{value:"INPUT"},"INPUT",-1),e("option",{value:"OUTPUT"},"OUTPUT",-1),e("option",{value:"FORWARD"},"FORWARD",-1)]),512),[[y,o.value.chain]])]),e("div",le,[s[22]||(s[22]=e("label",{for:"target",class:"form-label"},"Target",-1)),b(e("select",{id:"target","onUpdate:modelValue":s[3]||(s[3]=l=>o.value.target=l),class:"form-select",required:""},s[21]||(s[21]=[e("option",{value:""},"Select Target",-1),e("option",{value:"ACCEPT"},"ACCEPT",-1),e("option",{value:"DROP"},"DROP",-1),e("option",{value:"REJECT"},"REJECT",-1)]),512),[[y,o.value.target]])])]),e("div",te,[e("div",oe,[s[23]||(s[23]=e("label",{for:"source",class:"form-label"},"Source IP",-1)),b(e("input",{type:"text",id:"source","onUpdate:modelValue":s[4]||(s[4]=l=>o.value.source=l),class:"form-control",placeholder:"e.g., 192.168.1.0/24"},null,512),[[w,o.value.source]])]),e("div",ae,[s[24]||(s[24]=e("label",{for:"destination",class:"form-label"},"Destination IP",-1)),b(e("input",{type:"text",id:"destination","onUpdate:modelValue":s[5]||(s[5]=l=>o.value.destination=l),class:"form-control",placeholder:"e.g., 10.0.0.0/8"},null,512),[[w,o.value.destination]])])]),e("div",ne,[e("div",re,[s[26]||(s[26]=e("label",{for:"protocol",class:"form-label"},"Protocol",-1)),b(e("select",{id:"protocol","onUpdate:modelValue":s[6]||(s[6]=l=>o.value.protocol=l),class:"form-select"},s[25]||(s[25]=[e("option",{value:""},"Any",-1),e("option",{value:"tcp"},"TCP",-1),e("option",{value:"udp"},"UDP",-1),e("option",{value:"icmp"},"ICMP",-1)]),512),[[y,o.value.protocol]])]),e("div",ie,[s[27]||(s[27]=e("label",{for:"port",class:"form-label"},"Port",-1)),b(e("input",{type:"text",id:"port","onUpdate:modelValue":s[7]||(s[7]=l=>o.value.port=l),class:"form-control",placeholder:"e.g., 80, 443, 22"},null,512),[[w,o.value.port]])])])],32)]),e("div",de,[e("button",{type:"button",class:"btn btn-secondary",onClick:s[8]||(s[8]=l=>v.value=!1)},"Cancel"),e("button",{type:"button",class:"btn btn-primary",onClick:C,disabled:p.value},[p.value?(r(),n("span",ce)):h("",!0),s[28]||(s[28]=c(" Add Rule "))],8,ue)])])])])):h("",!0),e("div",be,[d.value.show?(r(),n("div",ve,[e("div",pe,[e("i",{class:_(d.value.type==="success"?"bi bi-check-circle-fill text-success":"bi bi-exclamation-triangle-fill text-danger")},null,2),e("strong",me,i(d.value.type==="success"?"Success":"Error"),1),e("button",{type:"button",class:"btn-close ms-auto",onClick:s[9]||(s[9]=l=>d.value.show=!1)})]),e("div",fe,i(d.value.message),1)])):h("",!0)])]))}},Ce=A(ge,[["__scopeId","data-v-b0a61573"]]);export{Ce as default};
